<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ms. Hanafi's Ap Integration Test</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Palatino+Linotype&display=swap');

    body {
      font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, serif;
      background-color: #f0f0f0;
      color: #000;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    .container {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2em;
    }

    .question-box {
      background: #ffffffee;
      border-radius: 12px;
      box-shadow: 0 0 10px #aaa;
      padding: 2em;
      max-width: 700px;
      width: 100%;
      margin-bottom: 2em;
      text-align: center;
      
    }

    #question-text {
      margin-bottom: 1.2em;
      font-size: 1.25rem;
      font-weight: 600;
    }

    .answers {
      display: flex;
      flex-direction: column;
      gap: 1em;
    }

    .answers button {
      position: relative;
      background-color: #dceeff;
      border: 2px solid #b0d0f0;
      border-radius: 10px;
      padding: 1em;
      font-size: 1rem;
      font-family: inherit;
      text-align: left;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
      overflow: hidden; /* to clip the fill bar */
    }
    
    .answers button .fill-bar {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      background-color: rgba(42, 118, 255, 0.3); /* light blue, semi-transparent */
      width: 0;
      transition: width 1s ease;
      pointer-events: none;
      z-index: 0;
    }
    
    .answers button span.answer-text {
      position: relative;
      z-index: 1;
    }


    .answers button:hover {
      background-color: #c7e5ff;
      transform: scale(1.02);
    }

    .answers button.selected {
      background-color: #b8dbff;
      border-color: #7abaff;
    }

    .answers button.hidden {
      display: none;
    }

    #check-answer-btn {
      margin-top: 1.5em;
      padding: 0.8em 2em;
      font-size: 1.1rem;
      background-color: #0077ff;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s;
    }

    #check-answer-btn:hover {
      background-color: #005fcc;
    }

    .hint {
      margin-top: 1em;
      padding: 1em;
      background-color: #eee;
      border-radius: 10px;
      font-style: italic;
      display: none;
    }

    .lifelines {
      position: fixed;
      top: 50%;
      left: 1em;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 1.5em;
      z-index: 20;
    }

    .lifelines button {
      background-color: gold;
      border: none;
      border-radius: 10px;
      padding: 0.6em 1em;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 0 8px #ffd70088;
      transition: background 0.3s, transform 0.2s;
    }

    .lifelines button:hover:not(:disabled) {
      background-color: #ffd700;
      transform: scale(1.05);
    }

    .lifelines button:disabled {
      background: gray;
      cursor: not-allowed;
      color: #444;
      box-shadow: none;
    }
    
    .lifeline-item[disabled] img {
      filter: grayscale(100%) brightness(60%);
      cursor: not-allowed;
      pointer-events: none;
    }


    #give-up-btn {
      margin-top: 1em;
      padding: 0.6em 1.5em;
      background: #ddd;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
    }

    #give-up-btn:hover {
      background-color: #ccc;
    }

    .tracker {
      display: flex;
      justify-content: center;
      gap: 0.6em;
      padding: 1em 0;
      background: #e0e0e0;
      border-top: 2px solid #ccc;
    }
    
    .tracker div {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background-color: #bbb;
      color: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      font-family: 'Palatino Linotype', serif;
      font-size: 1.1rem;
      transition: background-color 0.3s;
      user-select: none;
    }
    
    .tracker div.correct {
      background-color: #2a76ff; /* blue for correct */
      color: #fff;
    }


    .start-screen,
    .result-screen {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background-color: #313fbd; /* updated bg */
      color: white; /* white text */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 2em;
      z-index: 10;
    }
    
    .lifeline-item[disabled] {
      pointer-events: none;
      opacity: 0.6;
    }

    .start-screen h1,
    .result-screen h2 {
      font-size: 3rem;
      font-weight: 900;
      color: white; /* changed from #ffd700 */
      margin-bottom: 1em;
    }
    
    
    .start-screen button,
    .result-screen button {
      padding: 1em 2em;
      font-size: 1.2em;
      background-color: white;
      color: black;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: transform 0.2s;
      font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, serif;
    }

    .start-screen button:hover,
    .result-screen button:hover {
      transform: scale(1.1);
      background-color: #e0e0e0; /* subtle hover */
    }
    
    .lifeline-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      user-select: none;
    }
    
    .lifeline-item img {
      height: 60px;
      transition: transform 0.2s, filter 0.3s;
    }
    
    .lifeline-item:hover img:not([disabled]) {
      transform: scale(1.1);
      filter: drop-shadow(0 0 5px #00aaff);
    }
    
    .lifeline-item[disabled] img {
      filter: grayscale(100%) brightness(60%);
      cursor: not-allowed;
      pointer-events: none;
    }
    
    .lifeline-label {
      margin-top: 0.3em;
      font-family: 'Palatino Linotype', serif;
      font-size: 0.9rem;
      color: #333;
      text-align: center;
      pointer-events: none; /* so text doesn’t block clicks */
      user-select: none;
    }
  </style>
</head>
<body>
  <div class="start-screen" id="start-screen">
    <h1>Who Wants to Get a Five?</h1>
    <button onclick="startGame()">Start Game</button>
  </div>

  <div class="container" id="quiz-container" style="display: none;">
    <div class="lifelines">
      <div class="lifeline-item" onclick="useFiftyFifty()">
        <img id="fifty-btn" src="https://assets.iflscience.com/assets/articleNo/71047/aImg/71241/coin-toss-meta.png" alt="50/50 Lifeline" title="50/50 Lifeline" />
        <div class="lifeline-label">50/50</div>
      </div>
      <div class="lifeline-item" onclick="askAudience()">
        <img id="audience-btn" src="https://cdn.sanity.io/images/7i1ps9pf/production/84c9406f1c438f37fbd6cc07730cd6c43b159b63-5644x3763.jpg" alt="Ask the Audience" title="Ask the Audience" />
        <div class="lifeline-label">Ask the Procters</div>
      </div>
      <div class="lifeline-item" onclick="phoneFriend()">
        <img id="phone-btn" src="https://media.istockphoto.com/id/1325458178/photo/whispering-the-right-answer.jpg?s=612x612&w=0&k=20&c=ktxzDRGE92e82T34yfjRU7GG8W6DAJA5hZyji8Pn3yg=" alt="Phone a Friend" title="Phone a Friend" />
        <div class="lifeline-label">Whisper to a Freind</div>
      </div>
    </div>


    <div class="question-box">
      <div id="question-text">Question appears here...</div>
      <div class="answers" id="answer-buttons">
        <button onclick="selectAnswer(this)">Answer A</button>
        <button onclick="selectAnswer(this)">Answer B</button>
        <button onclick="selectAnswer(this)">Answer C</button>
        <button onclick="selectAnswer(this)">Answer D</button>
      </div>
      <button id="check-answer-btn" onclick="checkAnswer()">Check Answer</button>
      <div class="hint" id="hint-box">Hint appears here</div>
      
    </div>
  </div>

  <div class="result-screen" id="result-screen" style="display: none;">
    <h2>Game Over!</h2>
    <p id="final-score-text"></p>
    <button onclick="restartGame()">Play Again</button>
  </div>

  <div class="tracker" id="progress-tracker"></div>

  <script>
    const categories = {
      sports: [
        {
          question: "Which country won the FIFA World Cup in 2018?",
          answers: ["Germany", "Brazil", "France", "Argentina"],
          correct: "France",
          hint: "The final was against Croatia."
        },
        {
          question: "How many players are on a basketball team on the court?",
          answers: ["5", "6", "7", "4"],
          correct: "5",
          hint: "It's a team of five."
        },
        {
          question: "What sport is Serena Williams famous for?",
          answers: ["Tennis", "Basketball", "Golf", "Soccer"],
          correct: "Tennis",
          hint: "She serves aces."
        }
      ],
      cars: [
        {
          question: "What company produces the Mustang?",
          answers: ["Chevrolet", "Toyota", "Ford", "Dodge"],
          correct: "Ford",
          hint: "American automaker."
        },
        {
          question: "Which country is known for Ferrari?",
          answers: ["France", "Germany", "Italy", "Japan"],
          correct: "Italy",
          hint: "Same country as pasta."
        },
        {
          question: "What does 'EV' stand for in the automotive industry?",
          answers: ["Electric Vehicle", "Engine Valve", "Eco Van", "Enhanced Vision"],
          correct: "Electric Vehicle",
          hint: "No gas needed."
        }
      ],
      math: [
        {
          question: "What is the integral of x dx?",
          answers: ["x^2", "x^2/2", "1/x", "ln(x)"],
          correct: "x^2/2",
          hint: "Power rule!"
        },
        {
          question: "What is 8 × 7?",
          answers: ["54", "56", "64", "58"],
          correct: "56",
          hint: "It's in the 50s."
        },
        {
          question: "What is 100 divided by 4?",
          answers: ["20", "25", "30", "15"],
          correct: "25",
          hint: "Quarter of 100."
        }
      ],
      animals: [
        {
          question: "Which animal is known as the king of the jungle?",
          answers: ["Tiger", "Elephant", "Lion", "Leopard"],
          correct: "Lion",
          hint: "Big cat with a mane."
        },
        {
          question: "Which animal is the largest mammal?",
          answers: ["Elephant", "Blue Whale", "Giraffe", "Rhino"],
          correct: "Blue Whale",
          hint: "Lives in the ocean."
        },
        {
          question: "How many legs does a spider have?",
          answers: ["6", "8", "10", "12"],
          correct: "8",
          hint: "More than insects."
        }
      ],
      school: [
        {
          question: "What is the chemical symbol for water?",
          answers: ["H2O", "O2", "CO2", "HO2"],
          correct: "H2O",
          hint: "Two hydrogen, one oxygen."
        },
        {
          question: "Who wrote 'Romeo and Juliet'?",
          answers: ["Shakespeare", "Hemingway", "Dickens", "Poe"],
          correct: "Shakespeare",
          hint: "Famous English playwright."
        },
        {
          question: "What planet is known as the Red Planet?",
          answers: ["Venus", "Saturn", "Mars", "Jupiter"],
          correct: "Mars",
          hint: "Named after a Roman god."
        }
      ]
    };

    let currentQuestion = 0;
    let selectedButton = null;
    let correctAnswers = 0;
    
    let questions = [];

    function selectQuestions() {
      questions = [
        getRandomQuestion(categories.sports),
        getRandomQuestion(categories.cars),
        getRandomQuestion(categories.math),
        getRandomQuestion(categories.animals),
        getRandomQuestion(categories.school)
      ];
    }
    
    function getRandomQuestion(categoryArray) {
      const index = Math.floor(Math.random() * categoryArray.length);
      return categoryArray[index];
    }

    function startGame() {
      document.getElementById("start-screen").style.display = "none";
      document.getElementById("quiz-container").style.display = "flex";
      document.getElementById("result-screen").style.display = "none";
      selectQuestions();
      currentQuestion = 0;
      correctAnswers = 0;
      selectedButton = null;

      createTracker();
      showQuestion();
    }

    function showQuestion() {
      const q = questions[currentQuestion];
      document.getElementById("question-text").innerText = q.question;
      const buttons = document.querySelectorAll("#answer-buttons button");
    
      buttons.forEach((btn, index) => {
        btn.classList.remove("selected", "hidden");
        btn.disabled = false;
        // Reset fill bar width:
        let fillBar = btn.querySelector(".fill-bar");
        if (!fillBar) {
          fillBar = document.createElement("div");
          fillBar.classList.add("fill-bar");
          btn.prepend(fillBar);
        }
        fillBar.style.width = '0';
    
        // Wrap answer text in span for layering
        btn.innerHTML = `<span class="answer-text">${q.answers[index]}</span>`;
      });
    
      document.getElementById("hint-box").style.display = "none";
      selectedButton = null;
    }


    function selectAnswer(button) {
      const buttons = document.querySelectorAll("#answer-buttons button");
      buttons.forEach(btn => btn.classList.remove("selected"));
      button.classList.add("selected");
      selectedButton = button;
    }

    function checkAnswer() {
      if (!selectedButton) return;
    
      const selectedText = selectedButton.innerText;
      const correctText = questions[currentQuestion].correct;
    
      if (selectedText === correctText) {
        // Add correct class to current question box in tracker
        const trackerBoxes = document.getElementById("progress-tracker").children;
        trackerBoxes[currentQuestion].classList.add("correct");
        correctAnswers++;
    
        currentQuestion++;
        if (currentQuestion < questions.length) {
          showQuestion();
        } else {
          // All questions answered correctly
          showResult(`Congrats! You answered all ${correctAnswers} questions correctly!`);
        }
      } else {
        // Wrong answer - end game immediately
        showResult(`Wrong answer! You got ${correctAnswers} right.<br>Correct answer: ${correctText}`);
      }
    }
    
    function showResult(message) {
      document.getElementById("quiz-container").style.display = "none";
      document.getElementById("result-screen").style.display = "flex";
      document.getElementById("progress-tracker").style.display = "none";

    
      // If a custom message passed, show it, else fallback to default
      if (message) {
        document.getElementById("final-score-text").innerHTML = message;
      } else {
        document.getElementById("final-score-text").innerText =
          `You answered ${correctAnswers} out of ${questions.length} questions correctly!`;
      }
    }
    
    function restartGame() {
      // Reset lifelines
      document.getElementById("fifty-btn").parentElement.removeAttribute("disabled");
      document.getElementById("audience-btn").parentElement.removeAttribute("disabled");
      document.getElementById("phone-btn").parentElement.removeAttribute("disabled");
    
      // Reset counters
      currentQuestion = 0;
      correctAnswers = 0;
    
      // Clear tracker
      document.getElementById("progress-tracker").innerHTML = '';
    
      // Show start screen, hide others
      document.getElementById("start-screen").style.display = "flex";
      document.getElementById("quiz-container").style.display = "none";
      document.getElementById("result-screen").style.display = "none";
    }

  function createTracker() {
    const tracker = document.getElementById("progress-tracker");
    tracker.innerHTML = '';
    for (let i = 0; i < questions.length; i++) {
      const box = document.createElement("div");
      box.innerText = i + 1;
      tracker.appendChild(box);
    }
  }



    function useFiftyFifty() {

      // Disable the 50/50 lifeline button visually and functionally
      const fiftyBtn = document.getElementById("fifty-btn").parentElement;
      fiftyBtn.setAttribute("disabled", true);
    
      // Hide two incorrect answers
      const q = questions[currentQuestion];
      const buttons = Array.from(document.querySelectorAll("#answer-buttons button"));
    
      // Find all incorrect buttons
      const incorrectButtons = buttons.filter(btn => btn.innerText !== q.correct);
    
      // Randomly pick 2 incorrect answers to hide
      let hiddenCount = 0;
      while (hiddenCount < 2 && incorrectButtons.length > 0) {
        // Random index from incorrectButtons array
        const randIndex = Math.floor(Math.random() * incorrectButtons.length);
        const btnToHide = incorrectButtons[randIndex];
        btnToHide.classList.add("hidden");
        btnToHide.disabled = true;
    
        // Remove the hidden button from array so we don't hide it twice
        incorrectButtons.splice(randIndex, 1);
        hiddenCount++;
      }
    }

    function askAudience() {
      const q = questions[currentQuestion];
      const correct = q.correct;
      const buttons = Array.from(document.querySelectorAll("#answer-buttons button"));
    
      // Generate initial random percentages
      let votes = buttons.map(btn => ({
        text: btn.innerText,
        percent: btn.innerText === correct ? getRandomInt(50, 80) : getRandomInt(5, 20)
      }));
    
      // Normalize so total = 100%
      let total = votes.reduce((sum, v) => sum + v.percent, 0);
      votes = votes.map(v => ({...v, percent: Math.round((v.percent / total) * 100)}));
    
      // Animate fill bars smoothly
      votes.forEach((vote, i) => {
        const btn = buttons[i];
        let fillBar = btn.querySelector(".fill-bar");
        if (!fillBar) {
          fillBar = document.createElement("div");
          fillBar.classList.add("fill-bar");
          btn.prepend(fillBar);
        }
        // Reset width first to trigger transition
        fillBar.style.width = '0';
        // Force reflow for transition restart
        void fillBar.offsetWidth;
        // Then set to vote percent
        fillBar.style.width = vote.percent + "%";
      });
    
      // Disable lifeline visually and functionally
      const audienceBtn = document.getElementById("audience-btn").parentElement;
      audienceBtn.setAttribute("disabled", true);
    }

    function phoneFriend() {
      const hint = questions[currentQuestion].hint;
      const hintBox = document.getElementById("hint-box");
      hintBox.innerText = "Jimmy says: " + hint;
      hintBox.style.display = "block";
    
      // Disable lifeline visually and functionally
      const phoneBtn = document.getElementById("phone-btn").parentElement;
      phoneBtn.setAttribute("disabled", true);
    }

    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
  </script>
</body>
</html>
